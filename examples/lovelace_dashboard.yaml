# FileFlows Dashboard - Lovelace Example Configuration
# Copy relevant sections to your dashboard configuration

# ============================================
# COMPLETE DASHBOARD VIEW
# ============================================
title: FileFlows
path: fileflows
icon: mdi:video-vintage
badges: []
cards:
  # Status Header Card
  - type: horizontal-stack
    cards:
      - type: entity
        entity: binary_sensor.fileflows_processing_active
        name: Processing
        icon: mdi:cog-sync
      - type: entity
        entity: sensor.fileflows_active_runners
        name: Runners
        icon: mdi:run-fast
      - type: entity
        entity: sensor.fileflows_unprocessed_files
        name: Queue
        icon: mdi:inbox

  # Main Control Card
  - type: entities
    title: System Control
    show_header_toggle: false
    entities:
      - entity: switch.fileflows_system_active
        name: System Active
        secondary_info: last-changed
      - type: divider
      - entity: button.fileflows_pause_system
        name: Pause Processing
      - entity: button.fileflows_resume_system
        name: Resume Processing
      - entity: button.fileflows_refresh_data
        name: Refresh Data

  # Current Processing Card
  - type: markdown
    title: Currently Processing
    content: |
      {% set current = states('sensor.fileflows_current_processing_file') %}
      {% set processing = state_attr('sensor.fileflows_processing_files', 'details') %}
      {% if current != 'None' and processing %}
      {% for file in processing %}
      **{{ file.name }}**
      - Progress: {{ file.progress }}%
      - Node: {{ file.node }}
      {% endfor %}
      {% else %}
      *No files currently processing*
      {% endif %}

  # File Statistics Card
  - type: glance
    title: File Statistics
    columns: 4
    show_state: true
    entities:
      - entity: sensor.fileflows_unprocessed_files
        name: Queue
        icon: mdi:inbox-full
      - entity: sensor.fileflows_processing_files
        name: Processing
        icon: mdi:progress-clock
      - entity: sensor.fileflows_processed_files
        name: Done
        icon: mdi:check-circle
      - entity: sensor.fileflows_failed_files
        name: Failed
        icon: mdi:alert-circle

  # Storage Savings Gauge
  - type: gauge
    entity: sensor.fileflows_storage_saved_percent
    name: Storage Savings
    min: 0
    max: 100
    needle: true
    severity:
      green: 50
      yellow: 30
      red: 0
    segments:
      - from: 0
        color: '#db4437'
      - from: 30
        color: '#ffa600'
      - from: 50
        color: '#43a047'

  # Storage Statistics Card
  - type: entities
    title: Storage Statistics
    entities:
      - entity: sensor.fileflows_storage_saved
        name: Total Saved
        icon: mdi:harddisk
      - entity: sensor.fileflows_storage_saved_percent
        name: Savings Percentage
        icon: mdi:percent

  # Processing Nodes Card
  - type: entities
    title: Processing Nodes
    show_header_toggle: false
    entities:
      - entity: sensor.fileflows_nodes_count
        name: Total Nodes
      - type: divider
      # Add your node switches here - they will be auto-created
      # Example:
      # - entity: switch.fileflows_node_internal
      #   name: Internal Node
      # - entity: switch.fileflows_node_external
      #   name: External Node

  # Libraries Card
  - type: entities
    title: Libraries
    show_header_toggle: false
    entities:
      - entity: sensor.fileflows_libraries_count
        name: Total Libraries
      - type: divider
      # Add your library rescan buttons here - they will be auto-created
      # Example:
      # - entity: button.fileflows_rescan_movies
      #   name: Rescan Movies
      # - entity: button.fileflows_rescan_tv_shows
      #   name: Rescan TV Shows

  # System Information Card
  - type: entities
    title: System Information
    entities:
      - entity: sensor.fileflows_version
        name: Version
      - entity: sensor.fileflows_flows_count
        name: Flows
      - entity: sensor.fileflows_total_runners
        name: Total Runners

  # Queue List Card (if you have many files)
  - type: markdown
    title: Queue Preview
    content: |
      {% set files = state_attr('sensor.fileflows_unprocessed_files', 'files') %}
      {% if files %}
      | # | File |
      |---|------|
      {% for file in files[:5] %}
      | {{ loop.index }} | {{ file[:40] }}{% if file|length > 40 %}...{% endif %} |
      {% endfor %}
      {% if files|length > 5 %}
      
      *...and {{ files|length - 5 }} more files*
      {% endif %}
      {% else %}
      *Queue is empty*
      {% endif %}

# ============================================
# COMPACT OVERVIEW CARD (for sidebar/small spaces)
# ============================================
# - type: custom:mushroom-chips-card
#   chips:
#     - type: entity
#       entity: binary_sensor.fileflows_processing_active
#       icon_color: green
#     - type: entity
#       entity: sensor.fileflows_unprocessed_files
#     - type: entity
#       entity: sensor.fileflows_storage_saved

# ============================================
# MINI GRAPH CARD (requires mini-graph-card from HACS)
# ============================================
# - type: custom:mini-graph-card
#   name: Storage Saved
#   entities:
#     - entity: sensor.fileflows_storage_saved
#       name: GB Saved
#   hours_to_show: 168
#   points_per_hour: 1
#   line_color: '#43a047'
#   show:
#     graph: line
#     fill: fade
#     points: false

# ============================================
# HISTORY GRAPH
# ============================================
# - type: history-graph
#   title: Processing History
#   hours_to_show: 24
#   entities:
#     - entity: sensor.fileflows_processing_files
#       name: Processing
#     - entity: sensor.fileflows_unprocessed_files
#       name: Queue

# ============================================
# CONDITIONAL ALERT CARD
# ============================================
# - type: conditional
#   conditions:
#     - entity: binary_sensor.fileflows_has_failed_files
#       state: 'on'
#   card:
#     type: markdown
#     content: |
#       ## ⚠️ Processing Failures
#       **{{ states('sensor.fileflows_files_failed') }}** files have failed processing.
#       Check the FileFlows dashboard for details.
